---
- name: Create inventory
  hosts: localhost
  connection: local
  gather_facts: false

  pre_tasks:

    - name: Set global fact for base dir
      set_fact:
        play_dir: "{{ playbook_dir | dirname }}"

    - name: Include pre-tasks
      include_tasks: "{{ play_dir }}/pretasks.yml"
      vars:
        assert_vars:
          - filename
          - destname

  tasks:

    - name: Create inventory
      include_role:
        name: toolbox
      vars:
        toolbox:
          inventory: "{{ common.inventory }}"
        action_toolbox: doinventory

- name: Copy file
  hosts: linuxadhoc
  gather_facts: false


  tasks:

    - name: Copy single file to servers
      include_role:
        name: toolbox
      vars:
        toolbox:
          deploy:
            name: "{{ filename | default() }}"
            destination: "{{ destname | default() }}"
        action_toolbox: deploy
